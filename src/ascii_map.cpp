#include <map>
#include <string>
#include <vector>

#include "../inc/ascii_map.h"

const int DEFAULT_FONT_HEIGHT = 7;
const int DEFAULT_SCREEN_WIDTH = 80;
const int DEFAULT_SPACE_GAP = 4;

const std::map<char, std::vector<std::string>> asciiArtMap = {
    {'a',
     {
         "        ",
         "  __ _  ",
         " / _` | ",
         " \\__,_| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'b',
     {
         "  _     ",
         " | |__  ",
         " | '_ \\ ",
         " |_.__/ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'c',
     {
         "        ",
         "   __   ",
         "  / _|  ",
         "  \\__|_ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'d',
     {
         "     _  ",
         "  __| | ",
         " / _` | ",
         " \\__,_| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'e',
     {
         "        ",
         "   ___  ",
         "  / -_) ",
         "  \\___| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'f',
     {
         "     __ ",
         "    / _|",
         "   |  _|",
         "  _|_|_ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'g',
     {
         "   __ _ ",
         "  / _` |",
         "  \\__, |",
         "  |___/ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'h',
     {
         "  _     ",
         " | |_   ",
         " | ' \\  ",
         " |_||_| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'i',
     {
         "    _   ",
         "   (_)  ",
         "   | |  ",
         "  _|_|_ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'j',
     {
         "    (_) ",
         "    | | ",
         "   _/ | ",
         "  |__/_ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'k',
     {
         "   _    ",
         "  | |__ ",
         "  | / / ",
         "  |_\\_\\ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'l',
     {
         "    _   ",
         "   | |  ",
         "   | |  ",
         "  _|_|_ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'m',
     {
         "        ",
         "  _ __  ",
         " | '  \\ ",
         " |_|_|_|",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'n',
     {
         "        ",
         "  _ _   ",
         " | ' \\  ",
         " |_||_| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'o',
     {
         "        ",
         "   ___  ",
         "  / _ \\ ",
         "  \\___/ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'p',
     {
         "   _ __ ",
         "  | '_ \\",
         "  | .__/",
         "  |_|__ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'q',
     {
         "  __ _  ",
         " / _` | ",
         " \\__, | ",
         "  __|_| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'r',
     {
         "        ",
         "    _ _ ",
         "   | '_|",
         "  _|_|_ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'s',
     {
         "        ",
         "   ___  ",
         "  (_-<  ",
         "  /__/_ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'t',
     {
         "   _    ",
         "  | |_  ",
         "  |  _| ",
         "  _\\__| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'u',
     {
         "        ",
         "  _  _  ",
         " | +| | ",
         "  \\_,_| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'v',
     {
         "        ",
         "  __ __ ",
         "  \\ V / ",
         "  _\\_/_ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'w',
     {
         "        ",
         " __ __ _",
         " \\ V  V ",
         "  \\_/\\_/",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'x',
     {
         "        ",
         "  __ __ ",
         "  \\ \\ / ",
         "  /_\\_\\ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'y',
     {
         "   _  _ ",
         "  | || |",
         "   \\_, |",
         "  _|__/ ",
         "_| \"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'z',
     {
         "        ",
         "    ___ ",
         "   |_ / ",
         "  _/__| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'A',
     {
         "   ___  ",
         "  /   \\ ",
         "  | - | ",
         "  |_|_| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'B',
     {
         "   ___  ",
         "  | _ ) ",
         "  | _ \\ ",
         "  |___/ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'C',
     {
         "   ___  ",
         "  / __| ",
         " | (__  ",
         "  \\___| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'D',
     {
         "   ___  ",
         "  |   \\ ",
         "  | |) |",
         "  |___/ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'E',
     {
         "   ___  ",
         "  | __| ",
         "  | _|  ",
         "  |___| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'F',
     {
         "    ___ ",
         "   | __|",
         "   | _| ",
         "  _|_|_ ",
         "_| \"\"\" |",
         "\"`-0-0-'",
         "        ",
     }},
    {'G',
     {
         "   ___  ",
         "  / __| ",
         " | (_ | ",
         "  \\___| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'H',
     {
         "  _  _  ",
         " | || | ",
         " | __ | ",
         " |_||_| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'I',
     {
         "   ___  ",
         "  |_ _| ",
         "   | |  ",
         "  |___| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'J',
     {
         "      _ ",
         "   _ | |",
         "  | || |",
         "  _\\__/ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'K',
     {
         "  _  __ ",
         " | |/ / ",
         " | ' <  ",
         " |_|\\_\\ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'L',
     {
         "   _    ",
         "  | |   ",
         "  | |__ ",
         "  |____|",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'M',
     {
         " __  __ ",
         "|  \\/  |",
         "| |\\/| |",
         "|_|__|_|",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'N',
     {
         "  _  _  ",
         " | \\| | ",
         " | .` | ",
         " |_|\\_| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'O',
     {
         "   ___  ",
         "  / _ \\ ",
         " | (_) |",
         "  \\___/ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'P',
     {
         "    ___ ",
         "   | _ \\",
         "   |  _/",
         "  _|_|_ ",
         "_| \"\"\" |",
         "\"`-0-0-'",
         "        ",
     }},
    {'Q',
     {
         "  ___   ",
         " / _ \\  ",
         "| (_) | ",
         " \\__\\_\\ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'R',
     {
         "   ___  ",
         "  | _ \\ ",
         "  |   / ",
         "  |_|_\\ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'S',
     {
         "   ___  ",
         "  / __| ",
         "  \\__ \\ ",
         "  |___/ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'T',
     {
         "  _____ ",
         " |_   _|",
         "   | |  ",
         "  _|_|_ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'U',
     {
         "  _   _ ",
         " | | | |",
         " | |_| |",
         "  \\___/ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'V',
     {
         " __   __",
         " \\ \\ / /",
         "  \\ V / ",
         "  _\\_/_ ",
         "_| \"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'W',
     {
         "__      __",
         "\\ \\    / /",
         " \\ \\/\\/ / ",
         "  \\_/\\_/_ ",
         "_|\"\"\"\"''\"|",
         "\"`-0---0-'",
         "        ",
     }},
    {'X',
     {
         " __  __ ",
         " \\ \\/ / ",
         "  >  <  ",
         " /_/\\_\\ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'Y',
     {
         " __   __",
         " \\ \\ / /",
         "  \\ V / ",
         "  _|_|_ ",
         "_| \"\"\" |",
         "\"`-0-0-'",
         "        ",
     }},
    {'Z',
     {
         "   ____ ",
         "  |_  / ",
         "   / /  ",
         "  /___| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'+',
     {
         "  _|\"|_ ",
         " |_   _|",
         "   |_|  ",
         "  _____ ",
         "_|     |",
         "\"`-0-0-'",
         "        ",
     }},
    {'-',
     {
         "        ",
         "   ___  ",
         "  |___| ",
         "  _____ ",
         "_|     |",
         "\"`-0-0-'",
         "        ",
     }},
    {'!',
     {
         "    _   ",
         "   | |  ",
         "   |_|  ",
         "  _(_)_ ",
         "_| \"\"\" |",
         "\"`-0-0-'",
         "        ",
     }},
    {',',
     {
         "        ",
         "    _   ",
         "   ( )  ",
         "  _|/__ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'.',
     {
         "        ",
         "        ",
         "    _   ",
         "  _(_)_ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'?',
     {
         "   ___  ",
         "  |__ \\ ",
         "    /_/ ",
         "  _(_)_ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'1',
     {
         "   __   ",
         "  |_ |  ",
         "   | |  ",
         "  |___| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},

    {'2',
     {
         "   ___  ",
         "  |_  \\ ",
         "   / /_ ",
         "  /___| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'3',
     {
         "   ___  ",
         "  |__ | ",
         "   |_ | ",
         "  |___| ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'4',
     {
         "  _ _   ",
         " | | |  ",
         " |_  _| ",
         "  _|_|_ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'5',
     {
         "   ___  ",
         "  | __| ",
         "  |__ \\ ",
         "  |___/ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'6',
     {
         "    __  ",
         "   / /  ",
         "  / _ \\ ",
         "  \\___/ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'7',
     {
         "   ____ ",
         "  |__  |",
         "    / / ",
         "  _/_/_ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'8',
     {
         "   ___  ",
         "  ( _ ) ",
         "  / _ \\ ",
         "  \\___/ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'9',
     {
         "   ___  ",
         "  / _ \\ ",
         "  \\_, / ",
         "  _/_/_ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
    {'0',
     {
         "    __  ",
         "   /  \\ ",
         "  | () |",
         "  _\\__/ ",
         "_|\"\"\"\"\"|",
         "\"`-0-0-'",
         "        ",
     }},
};

// Default ASCII art if no match found
const std::vector<std::string> defaultArt = {"        ",      //
                                             "        ",      //
                                             "        ",      //
                                             " ______ ",      //
                                             "_|\"\"\"\"\"|", //
                                             "\"`-0-0-'",     //
                                             "        "};

std::vector<std::string> convertToASCIIArt (
    const std::string &text,
    int trailingWidth = DEFAULT_SCREEN_WIDTH)
{
    if (text.empty())
        return {};

    // Vector containing each row of the generated ASCII text art
    std::vector<std::string> displayText(DEFAULT_FONT_HEIGHT, "");

    for (size_t row = 0; row < DEFAULT_FONT_HEIGHT; row++) {
        displayText[row] += std::string(trailingWidth, ' ');
    }

    for (char key : text) {
        // std::map<>.find() returns an iterator pointing to a key-value pair
        auto iterator = asciiArtMap.find(key);

        // Iterator is std::map<>.end() IFF not found
        if (iterator != asciiArtMap.end()) {
            const auto &asciiArt = iterator->second;
            for (size_t row = 0; row < DEFAULT_FONT_HEIGHT; row++) {
                displayText[row] += asciiArt[row];
            }

        } else {
            // If match not found for a character, just display the character
            for (size_t row = 0; row < DEFAULT_FONT_HEIGHT; row++) {
                if (row != 3) {
                    displayText[row] += defaultArt[row];
                } else {
                    displayText[row] += "  __";
                    displayText[row] += key;
                    displayText[row] += "__ ";
                }
            }
        }
    }

    return displayText;
}
